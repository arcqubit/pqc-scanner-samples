# Vulnerability Index

Comprehensive catalog of all intentional vulnerabilities across PQC Scanner sample applications.

**Last Updated**: 2025-11-17
**Total Samples**: 5
**Total Vulnerabilities**: 94+

---

## Table of Contents

- [Summary by Sample](#summary-by-sample)
- [Summary by Vulnerability Type](#summary-by-vulnerability-type)
- [Quantum-Vulnerable Algorithms](#quantum-vulnerable-algorithms)
- [Deprecated Hash Functions](#deprecated-hash-functions)
- [Weak Ciphers](#weak-ciphers)
- [Configuration Issues](#configuration-issues)
- [Random Number Generation](#random-number-generation)
- [Cross-Reference Matrix](#cross-reference-matrix)

---

## Summary by Sample

| Sample | Language | Total | Critical | High | Medium | Low | Score |
|--------|----------|-------|----------|------|--------|-----|-------|
| **legacy-banking** | JavaScript | 15 | 5 | 7 | 3 | 0 | 28/100 |
| **crypto-messenger** | Python | 12 | 4 | 6 | 2 | 0 | 35/100 |
| **old-web-framework** | Java | 18 | 6 | 8 | 4 | 0 | 22/100 |
| **iot-device** | C++ | 14 | 7 | 5 | 2 | 0 | 18/100 |
| **polyglot-app** | Multi | 35+ | 15 | 15 | 8 | 0 | 31/100 |
| **TOTAL** | Mixed | **94+** | **37** | **41** | **19** | **0** | **27/100** |

---

## Summary by Vulnerability Type

### Quantum-Vulnerable Algorithms (45 instances)

| Algorithm | Instances | Samples | Severity | Quantum Attack |
|-----------|-----------|---------|----------|----------------|
| **RSA-1024** | 12 | 3 | Critical | Shor's Algorithm |
| **RSA-512** | 3 | 1 | Critical | Shor's Algorithm |
| **ECDSA** | 10 | 4 | Critical | Shor's Algorithm |
| **ECDH** | 8 | 3 | Critical | Shor's Algorithm |
| **DSA-1024** | 7 | 2 | Critical | Shor's Algorithm |
| **DH** | 5 | 3 | High | Shor's Algorithm |

### Deprecated Hash Functions (23 instances)

| Hash | Instances | Samples | Severity | Primary Attack |
|------|-----------|---------|----------|----------------|
| **MD5** | 15 | 5 | High | Collision Attack |
| **SHA-1** | 8 | 3 | High | Collision Attack |

### Weak Ciphers (18 instances)

| Cipher | Instances | Samples | Severity | Primary Attack |
|--------|-----------|---------|----------|----------------|
| **DES** | 5 | 2 | High | Brute Force |
| **3DES** | 6 | 2 | High | Sweet32 |
| **RC4** | 4 | 2 | High | Biased Keystream |
| **XOR (custom)** | 3 | 1 | High | Trivial Analysis |

### Configuration Issues (8 instances)

| Issue | Instances | Samples | Severity |
|-------|-----------|---------|----------|
| **Hardcoded Keys** | 4 | 3 | Critical |
| **Weak TLS** | 2 | 1 | High |
| **No Forward Secrecy** | 2 | 2 | High |

---

## Quantum-Vulnerable Algorithms

### RSA (15 total instances)

#### RSA-1024 (12 instances) - CRITICAL

**Vulnerability**: Key size vulnerable to Shor's algorithm on quantum computers. Estimated to be broken by quantum computers with ~2048 qubits.

**Affected Samples**:
1. **legacy-banking** (4 instances)
   - `src/crypto/key-generator.js:15` - RSA-1024 for transaction signing
   - `src/crypto/key-generator.js:28` - RSA-1024 for user authentication
   - `src/auth/session-manager.js:42` - RSA-1024 for session tokens
   - `src/utils/random.js:18` - RSA-1024 for API key generation

2. **old-web-framework** (5 instances)
   - `src/main/java/.../security/SignatureService.java:23` - RSA-1024 signatures
   - `src/main/java/.../config/SecurityConfig.java:67` - RSA-1024 for JWT
   - `src/main/java/.../controllers/AuthController.java:89` - RSA-1024 for OAuth
   - `src/main/java/.../security/FileIntegrity.java:34` - RSA-1024 for file signing
   - `src/main/java/.../security/DatabaseEncryption.java:45` - RSA-1024 for DB encryption

3. **polyglot-app** (3 instances)
   - `frontend/crypto-utils.js:12` - RSA-1024 for client-side encryption
   - `backend/crypto_service.py:34` - RSA-1024 for API security
   - `legacy-service/LegacyCrypto.java:56` - RSA-1024 for legacy integration

**Remediation**: Use RSA-4096 or transition to post-quantum algorithms (Kyber, Dilithium)

#### RSA-512 (3 instances) - CRITICAL

**Vulnerability**: Extremely weak key size, breakable even with classical computers.

**Affected Samples**:
1. **iot-device** (3 instances)
   - `src/crypto/device_auth.cpp:78` - RSA-512 for device authentication
   - `src/crypto/firmware_verify.cpp:23` - RSA-512 for firmware signatures
   - `src/storage/key_manager.cpp:45` - RSA-512 for key storage

**Remediation**: Immediate upgrade to RSA-4096 minimum, prefer post-quantum

---

### ECDSA (10 instances) - CRITICAL

**Vulnerability**: Elliptic curve discrete logarithm problem solvable by Shor's algorithm.

**Affected Samples**:
1. **crypto-messenger** (4 instances)
   - `app/crypto/signatures.py:12` - ECDSA P-256 for message signatures
   - `app/crypto/signatures.py:45` - ECDSA P-192 for user verification
   - `app/routes/messages.py:67` - ECDSA for API authentication
   - `app/models/user.py:34` - ECDSA for user key generation

2. **legacy-banking** (3 instances)
   - `src/crypto/transaction-signer.js:23` - ECDSA for transactions
   - `src/auth/session-manager.js:56` - ECDSA for session tokens
   - `src/crypto/key-generator.js:78` - ECDSA key pair generation

3. **polyglot-app** (3 instances)
   - `backend/crypto_service.py:89` - ECDSA P-384
   - `frontend/crypto-utils.js:45` - ECDSA for client signing
   - `microservices/crypto.go:23` - ECDSA for service-to-service auth

**Remediation**: Transition to Dilithium or SPHINCS+ (post-quantum signatures)

---

### ECDH (8 instances) - CRITICAL

**Vulnerability**: Key exchange vulnerable to quantum attacks via Shor's algorithm.

**Affected Samples**:
1. **crypto-messenger** (3 instances)
   - `app/crypto/key_exchange.py:15` - ECDH P-192 for key agreement
   - `app/crypto/key_exchange.py:45` - ECDH P-256 for session keys
   - `app/crypto/message_crypto.py:23` - ECDH for E2E encryption

2. **iot-device** (2 instances)
   - `src/crypto/device_auth.cpp:123` - ECDH for device pairing
   - `src/network/mqtt_client.cpp:67` - ECDH for secure channel

3. **polyglot-app** (3 instances)
   - `backend/crypto_service.py:123` - ECDH P-384
   - `lib-crypto/src/lib.rs:45` - ECDH implementation
   - `microservices/crypto.go:78` - ECDH for inter-service comm

**Remediation**: Use Kyber (post-quantum key encapsulation)

---

### DSA (7 instances) - CRITICAL

**Vulnerability**: Digital Signature Algorithm vulnerable to Shor's algorithm.

**Affected Samples**:
1. **old-web-framework** (4 instances)
   - `src/main/java/.../security/SignatureService.java:89` - DSA-1024
   - `src/main/java/.../config/CookieConfig.java:34` - DSA for cookie signing
   - `src/main/java/.../controllers/AuthController.java:123` - DSA verification
   - `src/test/java/SecurityTests.java:45` - DSA key generation

2. **polyglot-app** (3 instances)
   - `legacy-service/LegacyCrypto.java:123` - DSA-1024
   - `backend/crypto_service.py:156` - DSA signatures
   - `frontend/crypto-utils.js:89` - DSA verification

**Remediation**: Transition to Dilithium or FALCON

---

### DH (5 instances) - HIGH

**Vulnerability**: Diffie-Hellman key exchange vulnerable to quantum attacks.

**Affected Samples**:
1. **old-web-framework** (2 instances)
   - `src/main/java/.../config/SecurityConfig.java:156` - DH parameters
   - `src/main/java/.../security/DatabaseEncryption.java:78` - DH key agreement

2. **iot-device** (2 instances)
   - `src/crypto/device_auth.cpp:156` - DH for device pairing
   - `src/network/mqtt_client.cpp:89` - DH for TLS

3. **polyglot-app** (1 instance)
   - `microservices/crypto.go:123` - DH implementation

**Remediation**: Use Kyber for key encapsulation

---

## Deprecated Hash Functions

### MD5 (15 instances) - HIGH

**Vulnerability**: Collision attacks, rainbow table attacks, not cryptographically secure.

**Affected Samples**:
1. **legacy-banking** (4 instances)
   - `src/auth/password-hasher.js:12` - MD5 for password hashing
   - `src/crypto/transaction-signer.js:45` - MD5 for transaction integrity
   - `src/utils/random.js:34` - MD5 for token generation
   - `src/auth/session-manager.js:67` - MD5 for session IDs

2. **crypto-messenger** (3 instances)
   - `app/crypto/message_crypto.py:78` - MD5 for message integrity
   - `app/models/user.py:23` - MD5 for user IDs
   - `app/routes/messages.py:45` - MD5 checksums

3. **iot-device** (3 instances)
   - `src/crypto/firmware_verify.cpp:12` - MD5 for firmware integrity
   - `src/crypto/message_crypto.cpp:56` - MD5 for message hashing
   - `src/storage/key_manager.cpp:78` - MD5 for key derivation

4. **old-web-framework** (2 instances)
   - `src/main/java/.../security/FileIntegrity.java:67` - MD5 checksums
   - `src/main/java/.../controllers/AuthController.java:156` - MD5 for tokens

5. **polyglot-app** (3 instances)
   - `backend/crypto_service.py:189` - MD5 hashing
   - `frontend/crypto-utils.js:123` - MD5 for caching
   - `legacy-service/LegacyCrypto.java:234` - MD5 implementation

**Remediation**: Use SHA-256, SHA-3, or BLAKE2 for hashing; bcrypt/Argon2 for passwords

---

### SHA-1 (8 instances) - HIGH

**Vulnerability**: Collision attacks demonstrated (SHAttered), deprecated by NIST.

**Affected Samples**:
1. **old-web-framework** (4 instances)
   - `src/main/java/.../security/SignatureService.java:234` - SHA-1 signatures
   - `src/main/java/.../security/FileIntegrity.java:123` - SHA-1 checksums
   - `src/main/java/.../config/CookieConfig.java:89` - SHA-1 for cookies
   - `src/test/java/SecurityTests.java:156` - SHA-1 verification

2. **legacy-banking** (2 instances)
   - `src/crypto/transaction-signer.js:89` - SHA-1 for transaction IDs
   - `src/auth/password-hasher.js:45` - SHA-1 in HMAC

3. **polyglot-app** (2 instances)
   - `legacy-service/LegacyCrypto.java:345` - SHA-1 hashing
   - `microservices/crypto.go:156` - SHA-1 for checksums

**Remediation**: Use SHA-256, SHA-3, or BLAKE3

---

## Weak Ciphers

### DES (5 instances) - HIGH

**Vulnerability**: 56-bit key easily brute-forced, deprecated since 1999.

**Affected Samples**:
1. **legacy-banking** (3 instances)
   - `src/crypto/key-generator.js:123` - DES for encryption
   - `src/auth/session-manager.js:89` - DES for session tokens
   - `src/utils/random.js:67` - DES implementation

2. **polyglot-app** (2 instances)
   - `legacy-service/LegacyCrypto.java:456` - DES encryption
   - `backend/crypto_service.py:234` - DES for legacy support

**Remediation**: Use AES-256-GCM

---

### 3DES (6 instances) - HIGH

**Vulnerability**: Sweet32 attack, deprecated by NIST, slow performance.

**Affected Samples**:
1. **old-web-framework** (4 instances)
   - `src/main/java/.../security/DatabaseEncryption.java:123` - 3DES for DB
   - `src/main/java/.../config/SecurityConfig.java:234` - 3DES in TLS
   - `src/main/java/.../security/FileIntegrity.java:189` - 3DES for files
   - `src/main/java/.../controllers/AuthController.java:267` - 3DES for tokens

2. **polyglot-app** (2 instances)
   - `legacy-service/LegacyCrypto.java:567` - 3DES implementation
   - `backend/crypto_service.py:345` - 3DES for compatibility

**Remediation**: Use AES-256-GCM

---

### RC4 (4 instances) - HIGH

**Vulnerability**: Biased keystream, multiple statistical attacks, prohibited by RFC 7465.

**Affected Samples**:
1. **crypto-messenger** (2 instances)
   - `app/crypto/message_crypto.py:123` - RC4 stream cipher
   - `app/routes/messages.py:89` - RC4 for message encryption

2. **polyglot-app** (2 instances)
   - `frontend/crypto-utils.js:156` - RC4 implementation
   - `legacy-service/LegacyCrypto.java:678` - RC4 cipher

**Remediation**: Use ChaCha20-Poly1305 or AES-256-GCM

---

### XOR Cipher (3 instances) - HIGH

**Vulnerability**: Trivially broken with known-plaintext or ciphertext-only attacks.

**Affected Samples**:
1. **iot-device** (3 instances)
   - `src/crypto/message_crypto.cpp:123` - Custom XOR cipher
   - `src/crypto/firmware_verify.cpp:89` - XOR for obfuscation
   - `src/storage/key_manager.cpp:156` - XOR encryption

**Remediation**: Use proper authenticated encryption (AES-GCM, ChaCha20-Poly1305)

---

## Configuration Issues

### Hardcoded Cryptographic Keys (4 instances) - CRITICAL

**Vulnerability**: Keys in source code can be extracted, no key rotation possible.

**Affected Samples**:
1. **crypto-messenger** (2 instances)
   - `app/crypto/key_exchange.py:234` - Hardcoded AES key
   - `app/models/user.py:123` - Hardcoded HMAC secret

2. **legacy-banking** (1 instance)
   - `src/crypto/key-generator.js:234` - Hardcoded encryption key

3. **polyglot-app** (1 instance)
   - `backend/crypto_service.py:456` - Hardcoded JWT secret

**Remediation**: Use environment variables, key management services (AWS KMS, Azure Key Vault)

---

### Weak TLS Configuration (2 instances) - HIGH

**Vulnerability**: TLS 1.0/1.1 deprecated, vulnerable to BEAST, POODLE attacks.

**Affected Samples**:
1. **old-web-framework** (2 instances)
   - `src/main/java/.../config/SecurityConfig.java:345` - TLS 1.0 enabled
   - `src/main/java/.../config/SecurityConfig.java:367` - Weak cipher suites

**Remediation**: Use TLS 1.3, strong cipher suites only

---

### No Forward Secrecy (2 instances) - HIGH

**Vulnerability**: Static key exchange allows retroactive decryption if keys compromised.

**Affected Samples**:
1. **iot-device** (1 instance)
   - `src/network/mqtt_client.cpp:234` - Static RSA key exchange

2. **old-web-framework** (1 instance)
   - `src/main/java/.../config/SecurityConfig.java:456` - No ephemeral keys

**Remediation**: Use ephemeral key exchange (ECDHE, DHE), transition to Kyber

---

## Random Number Generation

### Weak PRNG (Multiple instances) - HIGH

**Vulnerability**: Predictable random numbers, not cryptographically secure.

**Affected Samples**:
1. **legacy-banking** (3 instances)
   - `src/utils/random.js:12` - Math.random() for tokens
   - `src/auth/session-manager.js:234` - Predictable session IDs
   - `src/crypto/key-generator.js:345` - Weak key generation

2. **polyglot-app** (2 instances)
   - `frontend/crypto-utils.js:234` - Math.random() for nonces
   - `backend/crypto_service.py:567` - Weak random seed

**Remediation**: Use cryptographically secure RNG (crypto.getRandomValues, secrets module, /dev/urandom)

---

## Cross-Reference Matrix

| Vulnerability Type | legacy-banking | crypto-messenger | old-web-framework | iot-device | polyglot-app |
|-------------------|----------------|------------------|-------------------|------------|--------------|
| **RSA-1024** | ✅ (4) | ❌ | ✅ (5) | ❌ | ✅ (3) |
| **RSA-512** | ❌ | ❌ | ❌ | ✅ (3) | ❌ |
| **ECDSA** | ✅ (3) | ✅ (4) | ❌ | ❌ | ✅ (3) |
| **ECDH** | ❌ | ✅ (3) | ❌ | ✅ (2) | ✅ (3) |
| **DSA** | ❌ | ❌ | ✅ (4) | ❌ | ✅ (3) |
| **DH** | ❌ | ❌ | ✅ (2) | ✅ (2) | ✅ (1) |
| **MD5** | ✅ (4) | ✅ (3) | ✅ (2) | ✅ (3) | ✅ (3) |
| **SHA-1** | ✅ (2) | ❌ | ✅ (4) | ❌ | ✅ (2) |
| **DES** | ✅ (3) | ❌ | ❌ | ❌ | ✅ (2) |
| **3DES** | ❌ | ❌ | ✅ (4) | ❌ | ✅ (2) |
| **RC4** | ❌ | ✅ (2) | ❌ | ❌ | ✅ (2) |
| **XOR Cipher** | ❌ | ❌ | ❌ | ✅ (3) | ❌ |
| **Hardcoded Keys** | ✅ (1) | ✅ (2) | ❌ | ❌ | ✅ (1) |
| **Weak TLS** | ❌ | ❌ | ✅ (2) | ❌ | ❌ |
| **No Forward Secrecy** | ❌ | ❌ | ✅ (1) | ✅ (1) | ❌ |
| **Weak PRNG** | ✅ (3) | ❌ | ❌ | ❌ | ✅ (2) |

---

## Remediation Priority

### Critical (Immediate Action Required)

1. **Replace RSA-512** (iot-device) - Use RSA-4096 or Kyber
2. **Remove Hardcoded Keys** (all affected samples) - Use environment variables/KMS
3. **Upgrade RSA-1024** (legacy-banking, old-web-framework, polyglot-app) - Use RSA-4096 or Kyber
4. **Replace ECDSA** (crypto-messenger, legacy-banking, polyglot-app) - Use Dilithium

### High (Action Required Soon)

1. **Replace MD5 hashing** (all samples) - Use SHA-256, SHA-3, or BLAKE3
2. **Upgrade SHA-1** (old-web-framework, legacy-banking, polyglot-app) - Use SHA-256 or SHA-3
3. **Replace DES/3DES** (legacy-banking, old-web-framework, polyglot-app) - Use AES-256-GCM
4. **Remove RC4** (crypto-messenger, polyglot-app) - Use ChaCha20-Poly1305
5. **Fix XOR cipher** (iot-device) - Use proper AEAD
6. **Upgrade TLS** (old-web-framework) - Use TLS 1.3
7. **Add Forward Secrecy** (iot-device, old-web-framework) - Use ephemeral keys

### Medium (Address in Planning)

1. **Replace ECDH** (crypto-messenger, iot-device, polyglot-app) - Use Kyber
2. **Replace DSA** (old-web-framework, polyglot-app) - Use Dilithium
3. **Replace DH** (old-web-framework, iot-device, polyglot-app) - Use Kyber
4. **Fix Weak PRNG** (legacy-banking, polyglot-app) - Use CSPRNG

---

**For detailed remediation guidance for each sample, see individual VULNERABILITIES.md files in each sample directory.**

**Last Updated**: 2025-11-17
